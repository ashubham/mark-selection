!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).Markee={})}(this,function(e){"use strict";let t={initialText:"I am a sample text, you can highlight me!",startIdx:0,endIdx:1,markerClass:"marker",tokenClass:"token",beginClass:"begin",endClass:"end",selectedClass:"selected",draggedClass:"dragged",hideDragGhost:!1};class s{constructor(e,s){this.el=e,this.config=s,this.config=Object.assign({},t,this.config),this.createTokens(),this.initContainer(),this.initDragEvents(),this.initClickEvents(),this.updateSelectedChildren()}initContainer(){this.el.style.display="flex",this.el.style.userSelect="none",this.begin=this.createMarker(!0,2*this.config.startIdx),this.end=this.createMarker(!1,2*this.config.endIdx),this.el.appendChild(this.begin.node),this.el.appendChild(this.end.node)}createTokens(){this.el.innerHTML=this.config.initialText.split(" ").map((e,t)=>{let s=2*t+1,i=t>=this.config.startIdx&&t<this.config.endIdx?this.config.selectedClass:"";return`<div class="${this.config.tokenClass} ${i}" data-order=${s} style="order:${s}">`+`${e}</div>`}).join("")}initDragEvents(){this.el.addEventListener("dragstart",e=>{let t=e.target;t.classList.contains(this.config.markerClass)&&(this.dragged=t.id===this.config.beginClass?this.begin:this.end,this.config.hideDragGhost&&(t.style.opacity="0",e.dataTransfer.setDragImage(t,0,0)),e.dataTransfer.setData("Text","random"),e.dataTransfer.setData("text/plain",t.id),setTimeout(()=>{t.style.opacity="1",t.classList.add(this.config.draggedClass)}))}),this.el.addEventListener("dragenter",e=>{let t=e.target;if(this.dragged&&this.isToken(t)){let e=Number.parseInt(t.dataset.order);this.dragged===this.begin&&e+1<=this.end.order?this.updateSelection(this.dragged,e-1,t):this.dragged===this.end&&e-1>=this.begin.order&&this.updateSelection(this.dragged,e+1,t)}}),this.el.addEventListener("dragend",e=>{e.target.classList.remove(this.config.draggedClass),this.dragged=null})}initClickEvents(){this.el.addEventListener("click",e=>{let t=e.target;if(this.isToken(t)){let e=Number.parseInt(t.dataset.order);this.begin.order=e-1,this.begin.node.style.order=""+this.begin.order,this.end.order=e+1,this.end.node.style.order=""+this.end.order,this.updateSelectedChildren()}})}isToken(e){return e.classList.contains(this.config.tokenClass)}updateSelection(e,t,s){e.node.style.order=""+t,e.order=t,this.updateSelectedChildren()}updateSelectedChildren(){let e="",t=this.begin.order/2,s=this.end.order/2;Array.from(this.el.children).forEach((i,n)=>{n>=t&&n<s?(i.classList.add(this.config.selectedClass),e+=" "+i.textContent):i.classList.remove(this.config.selectedClass)}),this.config.onMarked(e,t,s-1,this.begin.node,this.end.node)}createMarker(e=!1,t){let s=document.createElement("div"),i=e?this.config.beginClass:this.config.endClass;return s.innerHTML=`<div draggable=true class="${this.config.markerClass} ${i}"`+` id=${i} style="order:${t}"></div>`,{node:s.firstElementChild,order:t,isBegin:e}}}e.default=s,e.Markee=s,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=markee.js.map
